(function(c,a,d,e){var b={};b.init=function(){b.doCal();};b.doCal=function(){var f=new Calendar({element:d(".metrics-datepicker"),earliest_date:"January 1, 2006",latest_date:moment(),start_date:moment().subtract(29,"days"),end_date:moment(),callback:b.callback});
f.calendarSaveDates();};b.callback=function(){var i=moment(this.start_date).format("ll"),f=moment(this.end_date).format("ll");console.debug("Start Date: "+i+"\nEnd Date: "+f);
var h={action:"edd_metrics_change_date",start:i,end:f};var g="% over the last ";d(".edd-metrics-box h2").html('<div id="circleG"><div id="circleG_1" class="circleG"></div><div id="circleG_2" class="circleG"></div><div id="circleG_3" class="circleG"></div></div>');
d(".edd-metrics-box .bottom-text span").html("").removeClass();if(d(this.element[0]).hasClass("metrics-detail")){d.post(c.ajaxurl,h,b.detailResponse);}else{d.post(c.ajaxurl,h,b.dashResponse);
}};b.dashResponse=function(f){console.log(f);var h=JSON.parse(f);var g="% over previous "+h.dates.num_days+" days";d("#revenue").text("$"+h.earnings.total);
d("#revenue-compare span").text(h.earnings.compare.percentage+g).removeClass().addClass(h.earnings.compare.classes);d("#sales").text(h.sales.count);d("#sales-compare span").text(h.sales.compare.percentage+g).removeClass().addClass(h.sales.compare.classes);
d("#yearly").text("$"+h.earnings.avgyearly.total);d("#avgyearly-compare span").text(h.earnings.avgyearly.compare.percentage+g).removeClass().addClass(h.earnings.avgyearly.compare.classes);
d("#avgpercust").text("$"+h.earnings.avgpercust.total);d("#avgpercust-compare span").text(h.earnings.avgpercust.compare.percentage+g).removeClass().addClass(h.earnings.avgpercust.compare.classes);
d("#renewals").text(h.renewals.count);d("#renewal-amount").text("$"+h.renewals.earnings);d("#renewals-compare span").text(h.renewals.compare.percentage+g).removeClass().addClass(h.renewals.compare.classes);
d("#refunds").text(h.refunds.count);d("#refund-amount").text("$"+h.refunds.losses);d("#refunds-compare span").text(h.refunds.compare.percentage+g).removeClass().addClass(h.refunds.compare.classes);
d(".detail-compare-first").text("$"+h.earnings.compare.total);d("#box-4 .bottom-text span").text(h.earnings.compare.percentage+"%");d("#box-5 .bottom-text span").text(h.earnings.detail.sixmoago.compare+"%");
d(".detail-compare-second").text("$"+h.earnings.detail.sixmoago.total);d(".detail-compare-third").text("$"+h.earnings.detail.twelvemoago.total);b.doChart(h.chart);
};b.detailResponse=function(f){console.log("detailResponse",f);var h=JSON.parse(f);var g=b.getQueryVariable("metric");switch(g){case"revenue":d(".detail-compare-first").text("$"+h.earnings.compare.total);
d("#box-4 .bottom-text span").text(h.earnings.compare.percentage+"%");d("#box-5 .bottom-text span").text(h.earnings.detail.sixmoago.compare+"%");d(".detail-compare-second").text("$"+h.earnings.detail.sixmoago.total);
d(".detail-compare-third").text("$"+h.earnings.detail.twelvemoago.total);break;case"renewals":break;default:}b.doChart(h.chart);};b.getQueryVariable=function(f){var h=c.location.search.substring(1);
var j=h.split("&");for(var g=0;g<j.length;g++){var k=j[g].split("=");if(k[0]==f){return k[1];}}return(false);};b.doChart=function(g){console.log(g.daily);
var h={labels:g.labels,datasets:[{label:"Revenue",fill:false,lineTension:0.1,backgroundColor:"#fafafa",borderColor:"#0073aa",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"#0073aa",pointBackgroundColor:"#fff",pointBorderWidth:2,pointHoverRadius:5,pointHoverBackgroundColor:"#0073aa",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:4,pointHitRadius:10,data:g.earnings,spanGaps:false},{label:"Sales",data:g.sales}]};
var f=a.getElementById("metrics-chart");var i=new Chart(f,{type:"line",data:h,options:{scales:{xAxes:[{display:false,stacked:true}],}}});};jQuery(a).ready(b.init);
})(window,document,jQuery);